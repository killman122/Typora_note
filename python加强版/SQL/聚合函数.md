##  聚合函数

### 聚合函数的介绍

聚合函数又叫组函数，通常是对表中的数据进行统计和计算，一般结合分组(group by)来使用，用于统计和计算分组数据。___聚合函数不对null空值进行统计,使用\*除外___*包括了null值和not null 值

__常用的聚合函数:__

1. count(col):表示求指定列的总行数
2. max(col):表示求指定列的最大值
3. min(col):表示求指定列的最小值
4. sum(col): 表示求指定列的和
5. avg(col):表示求指定列的平均值

### 求总行数

```sql
-- 返回非NULL数据的总行数
select count(height) from students;
-- 返回总行数，包含null值记录;(还可以使用主键字段的id非空列)
select count(*) from students;
-- 查询男生的总身高
select sum(height) from students where gender = "男";
```

### 求最大值

```sql
-- 查询女生的编号最大值
select max(id) from students where gender = "女";
```

### 求最小值

```sql
-- 查询未删除学生的最小编号
select min(id) from students where is_delete = 0;
```

### 求平均值

```sql
-- 求男生的平均身高,包含身高为null的
select sum(height)/count(*) from students where gender = "男";//在这中计算中即使没有填写身高height,但是总人数不变,相当于身高按照0,统计升高
-- 求男生的平均身高,聚合函数不统计null值,平均身高有误
select avg(height) from students where gender = "男"; // 但是使用avg函数不会对null进行统计,所以只是计算有height的男生,所以总体人数的基数变小,导致除后的平均值变大
改进算法(计算身高未填写的) ifnull()函数,将第一个参数判断是否为空,在字段中如果为null,则使用第二个参数代替null值,这里第二个参数设置为0
select avg(ifnull(height,0)) from students where gender = "男";
```

__ifnull()函数判断指定的字段是否为null空值,如果是空值null则使用默认字段自己提供的字段(第二个参数)__

### 聚合函数的特点

聚合函数默认忽略字段为null的记录 要想列值为null的记录也参与计算，必须使用ifnull函数对null值做替换。

### 小结

- count(col):表示求指定列的总行数
- max(col):表示求指定列的最大值
- min(col):表示求指定列的最小值
- sum(col):表示求指定列的和
- avg(col):表示求指定列的平均值
